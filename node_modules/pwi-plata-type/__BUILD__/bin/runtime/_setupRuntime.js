"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.loadRuntimeLibs = loadRuntimeLibs;
const promises_1 = __importDefault(require("node:fs/promises"));
const node_path_1 = __importDefault(require("node:path"));
async function loadRuntimeLibs() {
    const plata = Object.create(null);
    const runtimeLibs = await promises_1.default.readdir(node_path_1.default.join(__dirname)).catch(err => {
        return {
            errorID: 'PRLORUNTIME',
            msg: err.message,
            error: err
        };
    });
    if (runtimeLibs.errorID !== undefined) {
        console.error(runtimeLibs);
        process.exit(1);
    }
    const promises = runtimeLibs.map(lib => Promise.resolve().then(() => new Promise(resolve => {
        if (lib.slice(-4) === 'd.ts')
            return resolve(true);
        if (node_path_1.default.extname(lib) === '.map')
            return resolve(true);
        const r = require(node_path_1.default.join(__dirname, lib));
        if (r.PlataRuntimeE === undefined) {
            return resolve(true);
        }
        for (const key in r.PlataRuntimeE) {
            plata[key] = r.PlataRuntimeE[key];
        }
        return resolve(true);
    })));
    await Promise.all(promises).catch(err => {
        console.error(err);
        process.exit(1);
    });
    return plata;
}
//# sourceMappingURL=_setupRuntime.js.map